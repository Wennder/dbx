<?php
/***
 *
 * @todo global, mysqldie wenn die id nicht vorhanden
 */
require_once('credentials.php');
require_once('classes/helper/Dbhelper.php');
require_once ('classes/other/geshi/geshi.php');


require_once('classes/Exploit.php');
require_once('classes/pExploit.php');
require ('classes/Platform.php');
require ('classes/pPlatform.php');

require_once 'classes/Category.php';
require_once 'classes/pCategory.php';
/**Passwörter*/
require_once 'classes/other/phpass-0.3/PasswordHash.php';
require_once 'classes/helper/Login.php';
require_once 'classes/helper/Session.php';
require_once 'classes/helper/Upload.php';
require_once 'classes/helper/Getvars.php';
require_once 'classes/helper/Formgen.php';
require_once 'classes/helper/AntiHitFaker.php';


$dbh=new PDO(DB_DSN, DB_USR, DB_PASS);
$dbh->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_WARNING);		//@todo das steht nur zum üben hier
?>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>show exploit</title>
<link rel="stylesheet" media="all" href="layout.css">
</head>
<body>
	<div id="head">
			<h1><a href="index.php">ue-cr3w exploits</a></h1>
		<img src="img/logo.png" alt="logo" />
	</div>
	<div>
	<?php 
	$varExploit=new Getvars();
	$varExploit->requireVar('view');
	
	if ($varExploit->validateVars()){
		//load 
		$e=new pExploit();
		$e->dbh($dbh);
		$e->mysqlSelect($varExploit->view());			
		$f=new Formgen();

		
		//output		
		$link= $f->getLink("download", $e->file());
		
		
		
		echo $f->getHeading($e->title(), 4);		
		echo "<div class=\"exploit-autor\">author:{$e->autor()}</div>";
		echo "<div class=\"exploit-date\">date:{$e->date()}</div>";
		echo "<div class=\"exploit-hits\">hits:{$e->hits()}</div>";
		echo "<div class=\"exploit-verified\">verified:{$e->verified()}</div>";
		echo '<div class="exploit-category">'.$e->loadCategory().'</div>';
		echo '<div class="exploit-platform">'.$e->loadPlatform().'</div>';
		echo "<div class=\"exploit-download\">$link</div>";
		echo '<div class="exploit-content">'.$e->getFormatedCode().'</div>';
		
		$e->mysqlUpdate();
	}//if show exploit		
	?>

	</div>
</body>
</html>
